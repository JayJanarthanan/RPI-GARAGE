<!DOCTYPE html>
<html>
	<head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<title>JANA GARAGE</title>

	<style type="text/css">
	#stream {
		height: 99%;
		margin: 0px auto;
		display: block;
		margin-top: 20px;
	}
	</style>
	


	 <!-- jQuery -->
	<script src="http://code.jquery.com/jquery.js"></script>
	<script src='/socket.io/socket.io.js'></script>
		
	<script>
		var socket = io();
		// Get data from the app.js file every x seconds and update our info.
		// status, time and actual measurement
		socket.on('status', function(data) {
			var status = document.getElementById('status');
			var range = document.getElementById('range');
			var time = document.getElementById('time');
			status.innerHTML = data.status;
			range.innerHTML = "Measured Range is: " + data.range;
			time.innerHTML = "Last Measured: " + data.time;
		});

		socket.on('liveStream', function(url) {
			$('#stream').attr('src', url);
			$('.start').hide();
		});
	
	  function startStream() {
    	socket.emit('start-stream');
    	$('.start').hide();
  		}


	</script>
	<script>
		//The javascript to create a POST request back to app.js to operate the door
		function open() { 
			var url = "/api/garage/open";
			var request = new XMLHttpRequest();
			request.open('POST', url, true);
			request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
			request.send({});
		}
	</script>	

	</head>

	<body>
		<div class="container">
			<header>
			   <h1>Jana Garage</h1>
			</header>
			<section>
				<h1>Status</h1>	
				<h2 id='status'>UNKNOWN</h2>
				<button type="button" onclick="open()" name="OPEN"> Operate Door </button>
				
				<h2>Visual</h2>
				<button type="button" id="" onclick="startStream()">Start Camera</button>

				<img id="stream" src="">

			
			</section>
			
			<section>
				<h1> Other Details </h1>
				<p id='temp'> Temperature </p>
				<p id='time'> Time </p>
				<p id='range'> Sensor Range:  </p>
			</section>
			
			<footer>Last updated 15 April 2017.</footer>
		</div>
	</body>
</html>
